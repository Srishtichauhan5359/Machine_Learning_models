spamD <- read.table('spam.tsv', header=T, sep='/t')
spamTrain <-subset(spamD, spamD$group>=10)
spamTest <- subset(spamD, spamD$group<10)
spamVars <- setdiff(colnames(spamD), list('rgroup','spam'))
spamFormula <-as.formula(paste('spam=="spam"',paste(spamVars, collapse= '+',sep='~'))
spamModel <- glm(spamformula, family=binomial (link='logit'),data=spamTrain)
spamTrain$predict <- predict(spamModel, newdata=spamTrain, type='response')
spamTest$predict <- predict(spamModel, newdata=spamTest, tyoe='response')
print(with(spamTest, table(y=spam, glmPred=pred>0.5)))